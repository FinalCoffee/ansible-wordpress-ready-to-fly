sudo: true
services:
    - docker

before_install:
    - docker info
    - docker version
    - docker build -f test/Dockerfile -t result-wordpress .

script:
    - docker run -v $(pwd):/data result-wordpress
    - IP=$(docker inspect --format '{{ .NetworkSettings.IPAddress }}' result-wordpress) ; echo http://$IP:80/ > url
    - cat url  |  xargs -t -n 1 curl -v -o result-wordpress

    - echo "==> Validating the test results..."
    - grep '<title>ANSIBLE_TEST' result-wordpress

notifications:
    webhooks: https://galaxy.ansible.com/api/v1/notifications/
